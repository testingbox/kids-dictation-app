<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°æœ‹å‹é»˜ç”Ÿå­—</title>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; background: #f0f8ff; }
    h1 { font-size: 24px; margin-bottom: 10px; }
    h2 { font-size: 16px; margin: 10px 0; }
    textarea { width: 100%; font-size: 16px; padding: 10px; border-radius: 10px; border: 1px solid #ccc; height: 120px; box-sizing: border-box; }
    .button-row { display: flex; justify-content: center; flex-wrap: nowrap; gap: 10px; margin: 10px auto; max-width: 320px; }
    .button-row .small-button:first-child { flex: 0 0 90px; }
    .button-row .small-button:last-child { flex: 1 1 200px; }
    .list-buttons, .game-buttons { display: flex; flex-direction: column; gap: 10px; margin-top: 10px; align-items: center; }
    .list-buttons .small-button, .game-buttons .small-button { min-width: 150px; }
    .small-button {
      padding: 10px;
      font-size: 14px;
      border: none;
      border-radius: 8px;
      background: #4CAF50;
      color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    select {
      width: 100%;
      font-size: 14px;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      margin: 5px 0;
    }
    #wordDisplay { font-size: 24px; margin-top: 20px; color: #333; min-height: 40px; }
    #counterDisplay { font-size: 16px; margin-top: 10px; color: #555; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div id="inputPage">
    <h1>é»˜ç”Ÿå­—å°ç¨‹å¼</h1>
    <h2>è¼¸å…¥ç”Ÿå­—ï¼Œä»¥é€—è™Ÿåˆ†éš”</h2>
    <textarea id="wordInput" placeholder="ä¾‹å¦‚ï¼šè˜‹æœ,é¦™è•‰,æ©™å­"></textarea>
    <div class="button-row">
      <button class="small-button" onclick="clearWords()">æ¸…ç©ºç”Ÿå­—</button>
      <button class="small-button" onclick="confirmWords()">âœ… å¿ƒä¸­è©¦é»˜</button>
    </div>
    <h2>ğŸ“š ç”Ÿå­—è¨˜éŒ„ç®¡ç†</h2>
    <select id="savedLists" onchange="loadSavedWords()">
      <option value="">é¸æ“‡å·²ä¿å­˜çš„æ¸…å–®</option>
    </select>
    <div class="list-buttons">
      <button class="small-button" onclick="saveCurrentWords()">ğŸ’¾ å„²å­˜æ¸…å–®</button>
      <button class="small-button" onclick="renameSelectedList()">âœï¸ é‡æ–°å‘½å</button>
      <button class="small-button" onclick="deleteSelectedList()">ğŸ—‘ï¸ åˆªé™¤æ¸…å–®</button>
    </div>
  </div>

  <div id="gamePage" class="hidden">
    <h2>æŠ½ç”Ÿå­—æœ—è®€</h2>
    <div id="counterDisplay">å°šæœªé–‹å§‹</div>
    <div id="wordDisplay">ï¼ˆè«‹å…ˆæŠ½å‡ºä¸€å€‹ç”Ÿå­—ï¼‰</div>
    <div class="game-buttons">
      <button class="small-button" onclick="drawWord()">ğŸ² æŠ½è®€ç”Ÿå­—</button>
      <button class="small-button" onclick="replayWord()">ğŸ” é‡è®€ç”Ÿå­—</button>
      <button class="small-button" onclick="showWord()">ğŸ‘ï¸ é¡¯ç¤ºç”Ÿå­—</button>
      <button class="small-button" onclick="backToInput()">ğŸ”™ è¿”å›ä¸»é </button>
    </div>
  </div>

  <div id="completePage" class="hidden">
    <h2>ğŸ‰ å®Œæˆï¼ä½ å·²é»˜å®Œ <span id="totalWords"></span> å€‹ç”Ÿå­—ï¼</h2>
    <button class="small-button" onclick="backToInput()">ğŸ”„ å†ä¾†ä¸€æ¬¡</button>
  </div>

  <script>
    let words = [], activeWords = [], currentWord = "", counter = 0;

    function clearWords() {
      document.getElementById('wordInput').value = "";
    }

    function confirmWords() {
      const input = document.getElementById('wordInput').value.trim();
      let wordList = input.split(',').map(word => word.trim()).filter(word => word);
      const uniqueWords = [...new Set(wordList)];
      if (uniqueWords.length === 0) {
        alert('è«‹è‡³å°‘è¼¸å…¥ä¸€å€‹ç”Ÿå­—ï¼');
        return;
      }
      document.getElementById('wordInput').value = uniqueWords.join(',');
      words = [...uniqueWords];
      activeWords = [...uniqueWords];
      counter = 0;
      currentWord = "";
      document.getElementById('counterDisplay').textContent = 'å°šæœªé–‹å§‹';
      document.getElementById('wordDisplay').textContent = 'ï¼ˆè«‹å…ˆæŠ½å‡ºä¸€å€‹ç”Ÿå­—ï¼‰';
      document.getElementById('inputPage').classList.add('hidden');
      document.getElementById('gamePage').classList.remove('hidden');
    }

    function drawWord() {
      if (activeWords.length === 0) {
        document.getElementById('totalWords').textContent = words.length;
        document.getElementById('gamePage').classList.add('hidden');
        document.getElementById('completePage').classList.remove('hidden');
        return;
      }
      const index = Math.floor(Math.random() * activeWords.length);
      currentWord = activeWords[index];
      activeWords.splice(index, 1);
      counter++;
      document.getElementById('wordDisplay').textContent = 'ï¼ˆè«‹ä½¿ç”¨é¡¯ç¤ºéµæŸ¥çœ‹ï¼‰';
      document.getElementById('counterDisplay').textContent = `å·²é»˜ç¬¬ ${counter} å€‹ï¼Œå°šé¤˜ ${activeWords.length} å€‹`;
      speak(currentWord);
    }

    function showWord() {
      if (!currentWord) {
        alert('è«‹å…ˆæŠ½å‡ºä¸€å€‹ç”Ÿå­—ï¼');
        return;
      }
      alert('å‰›æ‰æŠ½åˆ°çš„ç”Ÿå­—æ˜¯ï¼š' + currentWord);
    }

    function replayWord() {
      if (!currentWord) {
        alert('è«‹å…ˆæŠ½å‡ºä¸€å€‹ç”Ÿå­—ï¼');
        return;
      }
      speak(currentWord);
    }

    function speak(text) {
      if (!text) return;
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'zh-HK';
      utterance.rate = 0.9;
      speechSynthesis.speak(utterance);
    }

    function backToInput() {
      document.getElementById('inputPage').classList.remove('hidden');
      document.getElementById('gamePage').classList.add('hidden');
      document.getElementById('completePage').classList.add('hidden');
    }

    function saveCurrentWords() {
      const input = document.getElementById('wordInput').value.trim();
      if (!input) {
        alert('è«‹å…ˆè¼¸å…¥ç”Ÿå­—å…§å®¹ï¼');
        return;
      }
      const name = prompt('è«‹è¼¸å…¥æ¸…å–®åç¨±ï¼ˆä¾‹å¦‚ï¼šè‹±æ–‡é»˜æ›¸ï¼‰ï¼š');
      if (!name || name.trim() === '') {
        alert('å–æ¶ˆæˆ–åç¨±ç„¡æ•ˆ');
        return;
      }
      localStorage.setItem('dictation-' + name.trim(), input);
      loadSavedListOptions();
      alert('å·²ä¿å­˜ç”Ÿå­—æ¸…å–®ï¼');
    }

    function loadSavedListOptions() {
      const select = document.getElementById('savedLists');
      select.innerHTML = '<option value="">é¸æ“‡å·²ä¿å­˜çš„æ¸…å–®</option>';
      Object.keys(localStorage).forEach(key => {
        if (key.startsWith('dictation-')) {
          const option = document.createElement('option');
          option.value = key;
          option.textContent = key.replace('dictation-', '');
          select.appendChild(option);
        }
      });
    }

    function loadSavedWords() {
      const select = document.getElementById('savedLists');
      const key = select.value;
      if (!key) return;
      const data = localStorage.getItem(key);
      document.getElementById('wordInput').value = data;
      alert('å·²è¼‰å…¥ç”Ÿå­—æ¸…å–®ï¼');
    }

    function deleteSelectedList() {
      const select = document.getElementById('savedLists');
      const key = select.value;
      if (!key) {
        alert('è«‹å…ˆé¸æ“‡ä¸€å€‹æ¸…å–®');
        return;
      }
      if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹ç”Ÿå­—æ¸…å–®ï¼Ÿ')) {
        localStorage.removeItem(key);
        loadSavedListOptions();
        alert('å·²åˆªé™¤æ¸…å–®ï¼');
      }
    }

    function renameSelectedList() {
      const select = document.getElementById('savedLists');
      const oldKey = select.value;
      if (!oldKey) {
        alert('è«‹å…ˆé¸æ“‡ä¸€å€‹æ¸…å–®');
        return;
      }
      const newName = prompt('è«‹è¼¸å…¥æ–°çš„æ¸…å–®åç¨±ï¼š');
      if (!newName) return;
      const data = localStorage.getItem(oldKey);
      localStorage.removeItem(oldKey);
      localStorage.setItem('dictation-' + newName.trim(), data);
      loadSavedListOptions();
      alert('å·²é‡æ–°å‘½åæ¸…å–®ï¼');
    }

    window.onload = loadSavedListOptions;
  </script>
</body>
</html>
